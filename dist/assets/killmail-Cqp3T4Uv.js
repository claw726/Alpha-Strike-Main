import{l as H,i as M,a as I,s as C,b as v,t as S,e as L,g as x,h as D,j as A}from"./common-IQxCJoLi.js";let s=null;const e=(l,t="",i={})=>{var n,m;const o=I[x];let a=((n=S[l])==null?void 0:n[o])||((m=S[l])==null?void 0:m.en)||t||l;for(const c in i)a=a.replace(new RegExp(`{${c}}`,"g"),i[c]);return a},u=(l,t)=>l==null||typeof l=="string"&&l.trim()===""?e(`general.${t.toLowerCase()}`,t):String(l);function E(l,t){const i=document.createElement("div");i.className=`combatant-column-km ${t}-column`;const o=document.createElement("div");o.className=`combatant-card-km ${t}-card-km`;const a=document.createElement("div");a.className="combatant-header-km";const n=document.createElement("img");n.className="profile-image",n.alt=e(`altText.${t}Image`,`${t} ${l.name}`,{name:l.name}),n.src="../assets/images/default-avatar.avif";const m=document.createElement("div");m.className="combatant-info-km";const c=document.createElement("h3");c.className=`combatant-role-label ${t}`,c.textContent=e(`killmail.${t}Label`,t.toUpperCase());const r=document.createElement("h2");r.className=`${t} clickable-name`,r.dataset.name=l.name,r.title=e("tooltip.searchFor","Search for {itemName}",{itemName:l.name}),r.textContent=l.name;const d=document.createElement("p");d.innerHTML=`${e("killmail.corporationLabel","Corporation:")} <span class="placeholder">${e(`killmail.placeholder.${t}Corp`,`[${t} Corp Placeholder]`)}</span>`;const h=document.createElement("p"),p=t==="victim"&&(l.loss_type==="ship"||l.loss_type==="pod")?l.loss_type:e(`killmail.placeholder.${t}Ship`,`[${t} Ship Placeholder]`);return h.innerHTML=`${e("killmail.shipLabel","Ship:")} <span class="placeholder">${p}</span>`,m.appendChild(c),m.appendChild(r),m.appendChild(d),m.appendChild(h),a.appendChild(n),a.appendChild(m),o.appendChild(a),i.appendChild(o),i}function F(l){const t=document.createElement("div");t.className="engagement-details-km data-card";const i=document.createElement("h3");i.textContent=e("killmail.engagementDetailsTitle","Engagement Details");const o=document.createElement("p");o.innerHTML=`<strong>${e("killmail.lossTypeLabel","Loss Type:")}</strong> ${l.loss_type}`;const a=document.createElement("p");a.innerHTML=`<strong>${e("killmail.timeLabel","Time:")}</strong> ${D(l.time_stamp,A)}`;const n=document.createElement("p"),m=document.createElement("span");return m.className="clickable-system",m.dataset.system=l.solar_system_name,m.title=e("tooltip.searchFor","Search for {itemName}",{itemName:l.solar_system_name}),m.textContent=l.solar_system_name,n.innerHTML=`<strong>${e("killmail.locationLabel","Location:")}</strong> `,n.appendChild(m),n.innerHTML+=` (${e("card.idLabel","ID:")} ${l.solar_system_id})`,t.appendChild(i),t.appendChild(o),t.appendChild(a),t.appendChild(n),t}function P(l,t,i){const o=document.createElement("details");o.className="fitting-category",o.setAttribute("open","");const a=document.createElement("summary");a.innerHTML=`<i class="fas fa-${t}"></i> ${l}`;const n=document.createElement("ul");return i.forEach(m=>{const c=document.createElement("li"),r=document.createElement("span");r.className="placeholder",r.textContent=m,c.appendChild(r),n.appendChild(c)}),o.appendChild(a),o.appendChild(n),o}function R(){const l=document.createElement("div");l.className="fitting-section-km data-card";const t=document.createElement("h3");t.textContent=e("killmail.fittingTitle","Ship Fitting & Contents");const i=document.createElement("p");i.className="note",i.innerHTML=`<i class="fas fa-info-circle"></i> ${e("killmail.fittingNote","Note: Fitting data is placeholder.")}`;const o=document.createElement("div");return o.className="fitting-table-km",[{title:e("killmail.fitting.highSlots","High Slots"),icon:"crosshairs",items:[e("killmail.placeholder.highSlotItem1","[High Slot Item 1]"),e("killmail.placeholder.highSlotItem2","[High Slot Item 2]"),e("killmail.placeholder.emptyHighSlot","[Empty High Slot]")]},{title:e("killmail.fitting.midSlots","Mid Slots"),icon:"shield-alt",items:[e("killmail.placeholder.midSlotItem1","[Mid Slot Item 1]"),e("killmail.placeholder.midSlotItem2","[Mid Slot Item 2]"),e("killmail.placeholder.midSlotItem3","[Mid Slot Item 3]")]},{title:e("killmail.fitting.lowSlots","Low Slots"),icon:"cogs",items:[e("killmail.placeholder.lowSlotItem1","[Low Slot Item 1]"),e("killmail.placeholder.lowSlotItem2","[Low Slot Item 2]"),e("killmail.placeholder.lowSlotItem3","[Low Slot Item 3]")]},{title:e("killmail.fitting.rigs","Rigs"),icon:"microchip",items:[e("killmail.placeholder.rigSlotItem1","[Rig Slot Item 1]"),e("killmail.placeholder.rigSlotItem2","[Rig Slot Item 2]"),e("killmail.placeholder.rigSlotItem3","[Rig Slot Item 3]")]},{title:e("killmail.fitting.drones","Drones"),icon:"fighter-jet",items:[e("killmail.placeholder.droneItem1","[Drone Item 1]"),e("killmail.placeholder.droneItem2","[Drone Item 2]")]},{title:e("killmail.fitting.ammoCharges","Ammunition / Charges"),icon:"cubes",items:[e("killmail.placeholder.ammoItem1","[Ammo Item 1]"),e("killmail.placeholder.ammoItem2","[Ammo Item 2]"),e("killmail.placeholder.ammoItem3","[Ammo Item 3]")]},{title:e("killmail.fitting.cargoHold","Cargo Hold"),icon:"box-open",items:[e("killmail.placeholder.cargoItem1","[Cargo Item 1]"),e("killmail.placeholder.cargoItem2","[Cargo Item 2]"),e("killmail.placeholder.cargoItem3","[Cargo Item 3]")]}].forEach(n=>{o.appendChild(P(n.title,n.icon,n.items))}),l.appendChild(t),l.appendChild(i),l.appendChild(o),l}function $(l){const t=document.getElementById("killmail-content"),i=document.getElementById("killmail-page-title-container"),o=document.querySelector("title");if(!t||!i||!o){console.error("One or more essential DOM elements for killmail detail page are missing."),t&&(t.innerHTML=`<p class="error">${e("error.generic","An error occurred.")}</p>`);return}if(!l){t.innerHTML=`<p class="error">${e("error.killmailLoadFailed","Killmail data is not available to render.")}</p>`;return}const a=u(l.victim_name,"unknown"),n=u(l.killer_name,"notApplicable"),m=u(l.solar_system_name,"unknown"),c=u(l.loss_type,"classified");u(l.solar_system_id,"notApplicable"),o.textContent=e("killmail.pageTitlePattern","Killmail: {killerName} vs {victimName}",{killerName:n,victimName:a});const r=document.createElement("h1"),d=document.createElement("span");d.className="killer clickable-name",d.dataset.name=n,d.title=e("tooltip.searchFor","Search for {itemName}",{itemName:n}),d.textContent=n;const h=document.createElement("span");h.className="text-primary",h.textContent=` ${e("killmail.headerVs","vs")} `;const p=document.createElement("span");p.className="victim clickable-name",p.dataset.name=a,p.title=e("tooltip.searchFor","Search for {itemName}",{itemName:a}),p.textContent=a,r.appendChild(d),r.appendChild(h),r.appendChild(p);const k=document.createElement("p");k.className="system-location";const T=document.createTextNode(`${e("killmail.headerIncidentIn","Incident in")} `),g=document.createElement("span");g.className="clickable-system",g.dataset.system=m,g.title=e("tooltip.searchFor","Search for {itemName}",{itemName:m}),g.textContent=m,k.appendChild(T),k.appendChild(g),i.innerHTML="",i.appendChild(r),i.appendChild(k);const f=document.createElement("div");f.className="combatants-grid-km";const b={name:n,loss_type:c},y={name:a,loss_type:c};f.appendChild(E(b,"killer")),f.appendChild(E(y,"victim"));const w=F(l),_=R();t.innerHTML="",t.appendChild(f),t.appendChild(w),t.appendChild(_),typeof L=="function"&&L()}async function N(){const t=new URLSearchParams(window.location.search).get("mail_id"),i=document.getElementById("killmail-content");if(!i){console.error("killmail-content element not found in DOM.");return}if(t)try{if(!s){i.innerHTML=`<p data-translate="loading.killmail">${e("loading.killmail","Loading killmail data...")}</p>`;const a=localStorage.getItem("preferredLanguage")||I[0];typeof C=="function"&&C(a)}if(!s||s.id!==Number.parseInt(t)){const a=await v(t);if(!a||a.length===0)throw new Error(e("error.killmailNotFound","Killmail not found."));s=a[0]}$(s)}catch(a){console.error("Failed to load killmail data from API:",a),s=null,i.innerHTML=`<p class="error">${e("error.killmailLoadFailedApi",a.message||"Failed to load killmail data from API.")}</p>`}else s=null,i.innerHTML=`<p class="error">${e("error.noKillmailId","No killmail ID provided in URL.")}</p>`;const o=localStorage.getItem("preferredLanguage")||I[0];typeof C=="function"&&C(o)}document.addEventListener("DOMContentLoaded",async()=>{await H(),M("killmail_detail"),await N(),typeof window.AlphaStrike>"u"&&(window.AlphaStrike={}),window.AlphaStrike.onLanguageChangeRenderContent=()=>{console.log("Killmail page: Language change detected, re-rendering content."),s?$(s):N()}});
